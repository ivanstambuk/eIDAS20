# ============================================================================
# VCQ Clarification Questions: Trust Services Requirements
# Generated by: Opus (Phase 5)
# Date: 2026-01-30
# ============================================================================
# This file contains clarification questions for vendors providing qualified
# trust services (QTSP). Key themes include QTSP status, conformity assessment,
# QSCDs, security breach notification, remote signing, QEAAs, and liability.
# ============================================================================

schemaVersion: 1
sourceFile: requirements/trust_services.yaml
modelPasses:
  opus: true       # Completed 2026-01-30 - All trust services requirements processed
  gemini: true    # Completed 2026-01-30 - Gemini review pass finished

requirements:
  # ============================================================================
  # VEND-TSP-001: QTSP Status
  # Requirement: Obtain and maintain qualified trust service provider (QTSP) status
  # ============================================================================
  VEND-TSP-001:
    questions:
      - id: Q1
        text: "Do you hold QTSP status from an EU Member State conformity assessment body?"
        dimension: compliance_evidence
      - id: Q2
        text: "Which Member State issued your QTSP status, and are you listed on their Trusted List?"
        dimension: geographic_scope
      - id: Q3
        text: "Which qualified trust services does your QTSP status cover (QES, QSeal, QEAA, QTS)?"
        dimension: capability
      - id: Q4
        text: "How long have you maintained QTSP status?"
        dimension: experience
      - id: Q5
        text: "Have you ever had QTSP status suspended or revoked? If so, what were the circumstances?"
        dimension: compliance_history

  # ============================================================================
  # VEND-TSP-002: Conformity Assessment
  # Requirement: Undergo regular conformity assessment (at least every 24 months)
  # ============================================================================
  VEND-TSP-002:
    questions:
      - id: Q1
        text: "When was your last conformity assessment, and who conducted it?"
        dimension: compliance_evidence
      - id: Q2
        text: "What was the outcome of your most recent conformity assessment?"
        dimension: compliance_evidence
      - id: Q3
        text: "Were there any findings or non-conformities? How were they addressed?"
        dimension: compliance_history
      - id: Q4
        text: "When is your next conformity assessment scheduled?"
        dimension: lifecycle
      - id: Q5
        text: "Can you share the conformity assessment report with the organization?"
        dimension: documentation

  # ============================================================================
  # VEND-TSP-003: Supervisory Notification of Changes
  # Requirement: Notify supervisory body of changes affecting qualified status
  # ============================================================================
  VEND-TSP-003:
    questions:
      - id: Q1
        text: "What process do you have for notifying your supervisory body of significant changes?"
        dimension: compliance_monitoring
      - id: Q2
        text: "What types of changes trigger notification (organizational, security, policy)?"
        dimension: operational
      - id: Q3
        text: "How do you also notify customers when changes may affect the organization's use of your services?"
        dimension: lifecycle
      - id: Q4
        text: "How quickly after a change do you notify the supervisory body?"
        dimension: sla
      - id: Q5
        text: "Do you maintain a standing regular cadence with your Supervisory Body (SB) beyond mandatory incident reporting?"
        dimension: governance

  # ============================================================================
  # VEND-TSP-004: Qualified Signature/Seal Creation Devices (QSCDs)
  # Requirement: Use qualified electronic signature/seal creation devices (QSCDs)
  # ============================================================================
  VEND-TSP-004:
    questions:
      - id: Q1
        text: "What QSCDs do you use for qualified signature and seal creation?"
        dimension: technical_implementation
      - id: Q2
        text: "Are your QSCDs certified per Annex II of eIDAS? By which certification body?"
        dimension: compliance_evidence
      - id: Q3
        text: "Do you support Bring Your Own Key (BYOK) for organizations that want to control their own signing keys within your QSCDs?"
        dimension: flexibility
      - id: Q4
        text: "What physical and logical access controls protect QSCDs?"
        dimension: security
      - id: Q5
        text: "Do you require multi-person approval (quorum) for sensitive QSCD operations?"
        dimension: security
      - id: Q6
        text: "How do you manage QSCD lifecycle (procurement, activation, decommissioning)?"
        dimension: lifecycle

  # ============================================================================
  # VEND-TSP-005: Signature Creation Data Protection
  # Requirement: Protect signature/seal creation data against duplication and theft
  # ============================================================================
  VEND-TSP-005:
    questions:
      - id: Q1
        text: "What measures protect electronic signature creation data (private keys) from duplication?"
        dimension: security
      - id: Q2
        text: "What theft prevention controls are in place for signature creation data?"
        dimension: security
      - id: Q3
        text: "How do you detect and respond to unauthorized access attempts?"
        dimension: incident_response
      - id: Q4
        text: "What audit logging exists for signature creation operations?"
        dimension: auditability
      - id: Q5
        text: "Are signature creation operations monitored in real-time?"
        dimension: security

  # ============================================================================
  # VEND-TSP-006: Disaster Recovery and Business Continuity
  # Requirement: Maintain disaster recovery and business continuity capabilities
  # ============================================================================
  VEND-TSP-006:
    questions:
      - id: Q1
        text: "What is your Recovery Time Objective (RTO) for trust services?"
        dimension: sla
      - id: Q2
        text: "What is your Recovery Point Objective (RPO) for trust service data?"
        dimension: sla
      - id: Q3
        text: "How frequently are disaster recovery procedures tested?"
        dimension: compliance_monitoring
      - id: Q4
        text: "Where are your backup facilities located (geographic redundancy)?"
        dimension: geographic_scope
      - id: Q5
        text: "What was the outcome of your last disaster recovery test?"
        dimension: compliance_evidence
      - id: Q6
        text: "Do you have a documented termination plan to ensure service continuity?"
        dimension: lifecycle
      - id: Q7
        text: "Does your termination plan include provisions for transfer of revocation lists/OCSP services to a 'Trusted Archivist' to ensure long-term verifiability of past signatures?"
        dimension: lifecycle

  # ============================================================================
  # VEND-TSP-007: Security Breach Notification
  # Requirement: Notify supervisory body of security breaches within 24 hours
  # ============================================================================
  VEND-TSP-007:
    questions:
      - id: Q1
        text: "What is your process for detecting and classifying security breaches?"
        dimension: incident_response
      - id: Q2
        text: "How do you ensure supervisory body notification within 24 hours?"
        dimension: sla
      - id: Q3
        text: "Have you experienced any security breaches affecting trust services in the past 3 years?"
        dimension: compliance_history
      - id: Q4
        text: "How do you notify affected customers of security breaches?"
        dimension: incident_response
      - id: Q5
        text: "What post-incident remediation and review processes do you follow?"
        dimension: incident_response

  # ============================================================================
  # VEND-TSP-008: Remote Qualified Signature (TS8)
  # Requirement: Implement secure remote signature creation (TS8) if offering remote QES
  # ============================================================================
  VEND-TSP-008:
    questions:
      - id: Q1
        text: "Do you offer remote qualified electronic signature services?"
        dimension: capability
      - id: Q2
        text: "If so, how do you implement the remote signature creation protocols specified in TS8?"
        dimension: technical_implementation
      - id: Q3
        text: "How is signature creation data (private keys) securely managed on behalf of signatories?"
        dimension: security
      - id: Q4
        text: "What authentication mechanisms are used to authorize remote signature creation?"
        dimension: security
      - id: Q5
        text: "Is your remote signing implementation certified by a conformity assessment body?"
        dimension: compliance_evidence
      - id: Q6
        text: "Is your specific implementation of 'Sole Control' (e.g., mobile app binding covers) explicitly named in your Conformity Assessment Report?"
        dimension: compliance_evidence

  # ============================================================================
  # VEND-TSP-009: Sole Control Assurance
  # Requirement: Obtain sole control assurance for remote signing operations
  # ============================================================================
  VEND-TSP-009:
    questions:
      - id: Q1
        text: "How do you ensure the signatory has sole control over the signature creation process?"
        dimension: security
      - id: Q2
        text: "What multi-factor authentication is required before signature creation?"
        dimension: technical_implementation
      - id: Q3
        text: "How is explicit consent obtained for each signature operation?"
        dimension: user_experience
      - id: Q4
        text: "What audit trail exists for sole control verification?"
        dimension: auditability
      - id: Q5
        text: "Is your sole control mechanism certified or audited?"
        dimension: compliance_evidence

  # ============================================================================
  # VEND-TSP-010: WYSIWYS Support
  # Requirement: Support WYSIWYS (What You See Is What You Sign) for document signing
  # ============================================================================
  VEND-TSP-010:
    questions:
      - id: Q1
        text: "How do you present document content to signers before authorization (WYSIWYS)?"
        dimension: user_experience
      - id: Q2
        text: "What document formats are supported for WYSIWYS rendering?"
        dimension: interoperability
      - id: Q3
        text: "How do you handle documents with dynamic content or hidden elements?"
        dimension: security
      - id: Q4
        text: "Can signers scroll and review entire documents before signing?"
        dimension: user_experience
      - id: Q5
        text: "How do you ensure the signed document matches what was displayed?"
        dimension: security

  # ============================================================================
  # VEND-TSP-011: Qualified Timestamps
  # Requirement: Issue qualified timestamps from a trusted time source
  # ============================================================================
  VEND-TSP-011:
    questions:
      - id: Q1
        text: "Do you offer qualified electronic timestamp services?"
        dimension: capability
      - id: Q2
        text: "What time source do you use, and is it traceable to UTC?"
        dimension: technical_implementation
      - id: Q3
        text: "What is the accuracy of your timestamps?"
        dimension: sla
      - id: Q4
        text: "How do you ensure timestamp data cannot be modified undetectably?"
        dimension: security
      - id: Q5
        text: "What is the availability SLA for your timestamp authority?"
        dimension: sla

  # ============================================================================
  # VEND-TSP-012: QEAA Authentic Source Verification
  # Requirement: Issue QEAAs only after verifying data from authentic sources
  # ============================================================================
  VEND-TSP-012:
    questions:
      - id: Q1
        text: "What authentic sources do you connect to for QEAA attribute verification?"
        dimension: capability
      - id: Q2
        text: "How do you verify the data provenance from authentic sources?"
        dimension: security
      - id: Q3
        text: "What audit trail links QEAAs back to source verification?"
        dimension: auditability
      - id: Q4
        text: "How do you handle attributes not available from authentic sources (person-provided data)?"
        dimension: operational
      - id: Q5
        text: "What is the freshness of data from authentic sources at time of issuance?"
        dimension: sla

  # ============================================================================
  # VEND-TSP-013: QEAA Qualified Signature/Seal
  # Requirement: Sign QEAAs with qualified electronic signature or seal
  # ============================================================================
  VEND-TSP-013:
    questions:
      - id: Q1
        text: "Do you sign QEAAs with a qualified electronic signature or qualified electronic seal?"
        dimension: compliance_completeness
      - id: Q2
        text: "What signing algorithm and key length do you use for QEAA signatures?"
        dimension: technical_implementation
      - id: Q3
        text: "Is Post-Quantum Cryptography (PQC) on your roadmap for QEAA signing algorithms?"
        dimension: roadmap
      - id: Q4
        text: "Is your QEAA signing certificate included in Member State Trusted Lists?"
        dimension: compliance_evidence
      - id: Q5
        text: "What is your key rotation schedule for QEAA signing keys?"
        dimension: lifecycle
      - id: Q6
        text: "Do you support 'pre-hashing' of large datasets on the client side before submission to the signing service to reduce bandwidth and privacy exposure?"
        dimension: technical_implementation

  # ============================================================================
  # VEND-TSP-014: QEAA Revocation
  # Requirement: Provide QEAA revocation capability through status lists
  # ============================================================================
  VEND-TSP-014:
    questions:
      - id: Q1
        text: "What revocation mechanisms do you provide for QEAAs?"
        dimension: capability
      - id: Q2
        text: "How frequently are revocation status lists updated?"
        dimension: sla
      - id: Q3
        text: "What is the maximum propagation time for QEAA revocation?"
        dimension: sla
      - id: Q4
        text: "How do Relying Parties access your QEAA revocation information?"
        dimension: interoperability
      - id: Q5
        text: "Do you support QEAA suspension in addition to permanent revocation?"
        dimension: capability

  # ============================================================================
  # VEND-TSP-015: Financial Resources and Liability Insurance
  # Requirement: Maintain sufficient financial resources or liability insurance
  # ============================================================================
  VEND-TSP-015:
    questions:
      - id: Q1
        text: "What liability insurance coverage do you maintain for qualified trust services?"
        dimension: compliance_evidence
      - id: Q2
        text: "What is the coverage limit and scope of your liability insurance?"
        dimension: commercial
      - id: Q3
        text: "Can you provide proof of current insurance coverage?"
        dimension: documentation
      - id: Q4
        text: "How do you demonstrate adequate financial resources beyond insurance?"
        dimension: compliance_evidence
      - id: Q5
        text: "What is the claims process if a customer experiences damages?"
        dimension: operational

  # ============================================================================
  # VEND-TSP-016: Liability Acceptance
  # Requirement: Accept liability for qualified signatures/attestations issued
  # ============================================================================
  VEND-TSP-016:
    questions:
      - id: Q1
        text: "Do you accept liability for qualified services as specified in eIDAS Article 13?"
        dimension: compliance_completeness
      - id: Q2
        text: "What limitations on liability exist in your standard contract terms?"
        dimension: commercial
      - id: Q3
        text: "How do you handle claims for damages arising from verification or revocation failures?"
        dimension: incident_response
      - id: Q4
        text: "What indemnification provisions do you offer?"
        dimension: commercial
      - id: Q5
        text: "Have there been any liability claims against your trust services?"
        dimension: compliance_history

  # ============================================================================
  # VEND-TSP-017: Access Certificate Policy Compliance
  # Requirement: Comply with common Access Certificate Policy requirements
  # ============================================================================
  VEND-TSP-017:
    questions:
      - id: Q1
        text: "If acting as an Access Certificate Authority, do you comply with the Commission's common Certificate Policy?"
        dimension: compliance_completeness
      - id: Q2
        text: "What certificate issuance procedures do you follow?"
        dimension: technical_implementation
      - id: Q3
        text: "How do you provide certificate validation services (OCSP, CRL)?"
        dimension: capability
      - id: Q4
        text: "What is your certificate revocation process and timeline?"
        dimension: lifecycle
      - id: Q5
        text: "How do you support ecosystem participants in verifying access certificates?"
        dimension: interoperability

  # ============================================================================
  # VEND-TSP-018: Trust Service Suspension/Cancellation
  # Requirement: Handle suspension and cancellation of Trust Services
  # ============================================================================
  VEND-TSP-018:
    questions:
      - id: Q1
        text: "What notification process do you follow if your trust services are suspended or cancelled?"
        dimension: incident_response
      - id: Q2
        text: "What transition procedures ensure continuity for customers during suspension/cancellation?"
        dimension: lifecycle
      - id: Q3
        text: "How long are certificates/attestations still verifiable after service cancellation?"
        dimension: lifecycle
      - id: Q4
        text: "What arrangements exist for archive and repository access after service termination?"
        dimension: operational
      - id: Q5
        text: "Have you ever had trust services suspended? If so, what were the circumstances?"
        dimension: compliance_history

  # ============================================================================
  # VEND-TSP-019: Authentic Source Interface Implementation
  # Requirement: Implement authentic source verification for QTSPs
  # ============================================================================
  VEND-TSP-019:
    questions:
      - id: Q1
        text: "How do you implement the technical interfaces for authentic source access as specified in ARF Topic 42?"
        dimension: technical_implementation
      - id: Q2
        text: "How do you obtain and record User consent for authentic source queries?"
        dimension: privacy
      - id: Q3
        text: "How do you process verification responses according to ARF requirements (QTSPAS_05, QTSPAS_08)?"
        dimension: compliance_completeness
      - id: Q4
        text: "What authentic source response types can you handle (positive, negative, partial data)?"
        dimension: capability
      - id: Q5
        text: "How do you handle authentic source unavailability or errors?"
        dimension: operational
