# ============================================================================
# VCQ Clarification Questions: Issuer Requirements
# Generated by: Opus (Phase 2)
# Date: 2026-01-30
# ============================================================================
# This file contains detailed clarification questions designed to probe vendor
# implementations beyond simple compliance claims. Questions enable objective
# scoring based on depth of implementatioarchitecturen, lifecycle coverage, automation,
# and operational maturity.
# ============================================================================

schemaVersion: 1
sourceFile: requirements/issuer.yaml
modelPasses:
  opus: true       # Completed 2026-01-30 - All issuer requirements processed
  gemini: false    # Set to true after Gemini completes review pass

requirements:
  # ============================================================================
  # VEND-ISS-001: Attestation Provider Registration
  # Requirement: Register as an Attestation Provider with the competent authority
  # ============================================================================
  VEND-ISS-001:
    questions:
      - id: Q1
        text: "Do you provide tooling or services to register the organization as an Attestation Provider with Member State authorities?"
        dimension: capability
      - id: Q2
        text: "Which Member States do you currently support for Attestation Provider registration?"
        dimension: geographic_scope
      - id: Q3
        text: "What documentation and prerequisites must the organization provide for registration?"
        dimension: operational
      - id: Q4
        text: "What is the typical timeline from application to inclusion in Trusted Lists?"
        dimension: sla
      - id: Q5
        text: "How do you track and alert on registration status and renewal requirements?"
        dimension: lifecycle
      - id: Q6
        text: "Do you manage ongoing compliance with registration conditions on behalf of the organization?"
        dimension: compliance_monitoring

  # ============================================================================
  # VEND-ISS-002: Provider Information Publication
  # Requirement: Publish Provider Information according to the standard schema
  # ============================================================================
  VEND-ISS-002:
    questions:
      - id: Q1
        text: "Do you publish machine-readable Provider Information according to the data model in Annex I of Regulation 2024/2981?"
        dimension: capability
      - id: Q2
        text: "What metadata do you publish (supported attestation types, issuance policies, data sources, endpoints)?"
        dimension: technical_implementation
      - id: Q3
        text: "How is the Provider Information discovered by wallets and Relying Parties?"
        dimension: interoperability
      - id: Q4
        text: "Is the Provider Information endpoint highly available? What is the uptime SLA?"
        dimension: sla
      - id: Q5
        text: "How do you validate that published information conforms to the required schema?"
        dimension: compliance_monitoring

  # ============================================================================
  # VEND-ISS-003: Provider Information Update Timeliness
  # Requirement: Update Provider Information within 24 hours of changes
  # ============================================================================
  VEND-ISS-003:
    questions:
      - id: Q1
        text: "How do you ensure Provider Information is updated within 24 hours when operational changes occur?"
        dimension: sla
      - id: Q2
        text: "Is the update process automated when configuration changes are made, or does it require manual intervention?"
        dimension: automation
      - id: Q3
        text: "What audit trail exists for Provider Information updates?"
        dimension: auditability
      - id: Q4
        text: "How are organizations alerted when an update is required but has not yet been published?"
        dimension: alerting

  # ============================================================================
  # VEND-ISS-004: Trusted List Inclusion (Qualified Attestations)
  # Requirement: Obtain inclusion in national or EU Trusted Lists if issuing qualified attestations
  # ============================================================================
  VEND-ISS-004:
    questions:
      - id: Q1
        text: "Do you support the organization's application for QTSP status and Trusted List inclusion?"
        dimension: capability
      - id: Q2
        text: "Which Member States' Trusted Lists can you support for inclusion?"
        dimension: geographic_scope
      - id: Q3
        text: "What assistance do you provide for the conformity assessment audit required for QTSP status?"
        dimension: compliance_evidence
      - id: Q4
        text: "How do you monitor Trusted List status and alert on any changes affecting the organization?"
        dimension: lifecycle
      - id: Q5
        text: "What is your experience with QTSP certification timelines in different Member States?"
        dimension: operational

  # ============================================================================
  # VEND-ISS-005: Dual Credential Format Support (mDoc + SD-JWT-VC)
  # Requirement: Issue attestations in BOTH mandated credential formats (mDoc and SD-JWT-VC)
  # ============================================================================
  VEND-ISS-005:
    questions:
      - id: Q1
        text: "Do you support issuing attestations in BOTH ISO 18013-5 (mDoc) and SD-JWT-VC formats simultaneously?"
        dimension: capability
      - id: Q2
        text: "When a wallet requests issuance, do you automatically issue in all mandated formats, or must each format be requested separately?"
        dimension: technical_implementation
      - id: Q3
        text: "How do you ensure format parity—that both mDoc and SD-JWT-VC contain identical attribute data?"
        dimension: interoperability
      - id: Q4
        text: "Do you publish supported formats in Provider Information per ARF ISSU_12a?"
        dimension: compliance_completeness
      - id: Q5
        text: "Which wallet implementations have you tested format compatibility with (e.g., EUDI reference wallet, Apple, Google, third-party)?"
        dimension: interoperability
      - id: Q6
        text: "Have you participated in EUDI Wallet plugfest or interoperability testing events?"
        dimension: compliance_evidence

  # ============================================================================
  # VEND-ISS-006: Cryptographic Device Binding
  # Requirement: Bind attestations to the Wallet Unit's cryptographic device
  # ============================================================================
  VEND-ISS-006:
    questions:
      - id: Q1
        text: "How do you cryptographically bind issued attestations to the Wallet Unit's secure cryptographic device (WSCD)?"
        dimension: technical_implementation
      - id: Q2
        text: "What proof-of-possession mechanism do you use during issuance to verify key ownership?"
        dimension: security
      - id: Q3
        text: "Do you support both single-attestation keys and wallet-wide device keys for binding?"
        dimension: flexibility
      - id: Q4
        text: "How is device binding verified during the issuance flow before the attestation is issued?"
        dimension: technical_implementation
      - id: Q5
        text: "Do you support key import (Bring Your Own Key) for device binding keys, or must keys be generated within your platform?"
        dimension: flexibility

  # ============================================================================
  # VEND-ISS-007: OpenID4VCI Protocol Implementation (TS6)
  # Requirement: Implement the OpenID4VCI issuance protocol (TS6)
  # ============================================================================
  VEND-ISS-007:
    questions:
      - id: Q1
        text: "Do you fully implement the OpenID for Verifiable Credential Issuance (OpenID4VCI) protocol as specified in ARF Technical Specification 6?"
        dimension: capability
      - id: Q2
        text: "Which OpenID4VCI grant types do you support (pre-authorized code flow, authorization code flow)?"
        dimension: technical_implementation
      - id: Q3
        text: "Do you support deferred credential issuance for asynchronous processing?"
        dimension: capability
      - id: Q4
        text: "What credential offer mechanisms do you support (QR codes, deep links, pushed authorization requests)?"
        dimension: interoperability
      - id: Q5
        text: "Which wallet implementations have you tested OpenID4VCI compatibility with?"
        dimension: interoperability
      - id: Q6
        text: "How do you handle issuance errors, retries, and partial failures?"
        dimension: operational

  # ============================================================================
  # VEND-ISS-008: Batch Issuance
  # Requirement: Support batch issuance for multiple attestations
  # ============================================================================
  VEND-ISS-008:
    questions:
      - id: Q1
        text: "Do you support batch issuance of multiple attestations in a single session?"
        dimension: capability
      - id: Q2
        text: "Is batch issuance processed synchronously or asynchronously?"
        dimension: technical_implementation
      - id: Q3
        text: "Do you offer a bulk upload interface (CSV, JSON) for high-volume batch issuance?"
        dimension: capability
      - id: Q4
        text: "What is the maximum batch size you have tested in production?"
        dimension: scalability
      - id: Q5
        text: "How are failures handled in batch issuance—does one failure abort the batch or continue with remaining?"
        dimension: operational
      - id: Q6
        text: "Can different attestation types be combined in a single batch issuance?"
        dimension: flexibility

  # ============================================================================
  # VEND-ISS-009: User Identity Verification
  # Requirement: Verify user identity before issuing attestations
  # ============================================================================
  VEND-ISS-009:
    questions:
      - id: Q1
        text: "What identity verification methods do you support (video identification, national eID, in-person verification)?"
        dimension: capability
      - id: Q2
        text: "What levels of assurance (LoA) can you achieve for identity proofing (Low, Substantial, High)?"
        dimension: compliance_completeness
      - id: Q3
        text: "Do you support identity verification using an existing PID in the wallet, in addition to independent proofing?"
        dimension: flexibility
      - id: Q4
        text: "Do you support FIDO2/WebAuthn for authentication during identity verification flows?"
        dimension: capability
      - id: Q5
        text: "How do you verify the identity of legal persons (organizations) requesting attestations?"
        dimension: capability
      - id: Q6
        text: "What audit trail is maintained for identity verification decisions?"
        dimension: auditability

  # ============================================================================
  # VEND-ISS-010: Authentic Source Data Provenance
  # Requirement: Obtain data from authentic sources with verified provenance
  # ============================================================================
  VEND-ISS-010:
    questions:
      - id: Q1
        text: "Which authentic sources do you connect to for attestation data (national registries, authoritative databases)?"
        dimension: capability
      - id: Q2
        text: "Do you support authentic sources in multiple EU Member States?"
        dimension: geographic_scope
      - id: Q3
        text: "Do you use mutual TLS (mTLS) or equivalent secure channels when connecting to authentic sources?"
        dimension: security
      - id: Q4
        text: "Do you maintain cryptographic audit trails linking attestations to source queries?"
        dimension: auditability
      - id: Q5
        text: "How do you handle source unavailability or data freshness issues?"
        dimension: operational
      - id: Q6
        text: "Can the organization integrate additional authentic sources through your platform?"
        dimension: flexibility

  # ============================================================================
  # VEND-ISS-011: Attestation Validity Period
  # Requirement: Include attestation validity period and issuance timestamp
  # ============================================================================
  VEND-ISS-011:
    questions:
      - id: Q1
        text: "Do you include clearly defined validity periods (valid_from, valid_until) in all issued attestations?"
        dimension: capability
      - id: Q2
        text: "How are validity periods determined for different attestation types?"
        dimension: technical_implementation
      - id: Q3
        text: "Can the organization configure attestation validity periods, or are they fixed?"
        dimension: flexibility
      - id: Q4
        text: "How do you handle clock synchronization to ensure accurate issuance timestamps?"
        dimension: technical_implementation
      - id: Q5
        text: "Do you notify users when their attestations are approaching expiry?"
        dimension: user_experience

  # ============================================================================
  # VEND-ISS-012: Attestation Renewal and Re-issuance
  # Requirement: Support attestation renewal and re-issuance workflows
  # ============================================================================
  VEND-ISS-012:
    questions:
      - id: Q1
        text: "Do you support workflows for renewing attestations before expiry?"
        dimension: capability
      - id: Q2
        text: "Can attestations be re-issued when the underlying data changes (e.g., address change)?"
        dimension: capability
      - id: Q3
        text: "How do users receive notifications of upcoming expiry?"
        dimension: user_experience
      - id: Q4
        text: "Is renewal automated, or does it require user action?"
        dimension: automation
      - id: Q5
        text: "When an attestation is renewed, is the old attestation automatically revoked?"
        dimension: lifecycle
      - id: Q6
        text: "What is the lead time for renewal notifications?"
        dimension: operational

  # ============================================================================
  # VEND-ISS-013: Attestation Status Lists (Revocation)
  # Requirement: Publish attestation status lists for revocation checking
  # ============================================================================
  VEND-ISS-013:
    questions:
      - id: Q1
        text: "Do you maintain and publish attestation status lists for revocation checking?"
        dimension: capability
      - id: Q2
        text: "What status list formats do you support (Token Status List, Attestation Status List)?"
        dimension: technical_implementation
      - id: Q3
        text: "How frequently are status lists updated?"
        dimension: sla
      - id: Q4
        text: "Is status list publication highly available? What is the uptime SLA?"
        dimension: sla
      - id: Q5
        text: "How do Relying Parties discover and access your status list endpoints?"
        dimension: interoperability
      - id: Q6
        text: "Do you support privacy-preserving status checks (e.g., using signed status assertions)?"
        dimension: privacy

  # ============================================================================
  # VEND-ISS-014: Revocation Propagation Timeliness
  # Requirement: Update revocation status within defined time limits
  # ============================================================================
  VEND-ISS-014:
    questions:
      - id: Q1
        text: "What is the maximum propagation time for standard attestation revocations?"
        dimension: sla
      - id: Q2
        text: "Do you support immediate revocation for critical security situations?"
        dimension: incident_response
      - id: Q3
        text: "How is revocation propagation time measured and audited?"
        dimension: auditability
      - id: Q4
        text: "What caching strategy is used for status lists, and how does this affect effective revocation time?"
        dimension: technical_implementation
      - id: Q5
        text: "How do you handle revocation during status list endpoint outages?"
        dimension: operational

  # ============================================================================
  # VEND-ISS-015: User Notification on Revocation
  # Requirement: Notify wallet users when their attestations are revoked
  # ============================================================================
  VEND-ISS-015:
    questions:
      - id: Q1
        text: "Do you notify users when their attestations are revoked?"
        dimension: capability
      - id: Q2
        text: "Through what channels are revocation notifications sent (push notification, email, in-app)?"
        dimension: technical_implementation
      - id: Q3
        text: "How quickly are notifications sent after revocation occurs?"
        dimension: sla
      - id: Q4
        text: "Does the notification include the reason for revocation and guidance for resolution?"
        dimension: user_experience
      - id: Q5
        text: "How do you handle notification delivery failures?"
        dimension: operational

  # ============================================================================
  # VEND-ISS-016: Attestation Suspension and Reinstatement
  # Requirement: Support suspension and reinstatement of attestations
  # ============================================================================
  VEND-ISS-016:
    questions:
      - id: Q1
        text: "Do you support temporary suspension of attestations (as distinct from permanent revocation)?"
        dimension: capability
      - id: Q2
        text: "What triggers can initiate attestation suspension (fraud investigation, user request, authority order)?"
        dimension: operational
      - id: Q3
        text: "Can suspended attestations be reinstated? What is the process?"
        dimension: lifecycle
      - id: Q4
        text: "How is suspension status reflected in the status lists?"
        dimension: technical_implementation
      - id: Q5
        text: "Are users notified when their attestations are suspended and when reinstated?"
        dimension: user_experience

  # ============================================================================
  # VEND-ISS-017: Signing Key Protection
  # Requirement: Protect attestation signing keys in secure cryptographic devices
  # ============================================================================
  VEND-ISS-017:
    questions:
      - id: Q1
        text: "Are attestation signing keys stored and used within Hardware Security Modules (HSMs) or equivalent secure cryptographic devices?"
        dimension: capability
      - id: Q2
        text: "What certification level do your cryptographic modules have (FIPS 140-2/3 Level 3, Common Criteria EAL4+)?"
        dimension: compliance_evidence
      - id: Q3
        text: "Do you support Bring Your Own Key (BYOK) for organizations that want to manage their own signing keys?"
        dimension: flexibility
      - id: Q4
        text: "Do you require multi-person approval (quorum/four-eye principle) for sensitive key operations?"
        dimension: security
      - id: Q5
        text: "Do you offer cloud-hosted HSM or require on-premises HSM deployment?"
        dimension: operational
      - id: Q6
        text: "How are HSM backup and disaster recovery handled without exposing keys?"
        dimension: operational

  # ============================================================================
  # VEND-ISS-018: Approved Signing Algorithms
  # Requirement: Use signing algorithms from the approved list
  # ============================================================================
  VEND-ISS-018:
    questions:
      - id: Q1
        text: "Which signing algorithms do you support from the approved list (ECDSA P-256, EdDSA Ed25519, RSA-PSS)?"
        dimension: technical_implementation
      - id: Q2
        text: "How do you ensure only approved algorithms are used for attestation signing?"
        dimension: compliance_monitoring
      - id: Q3
        text: "Do you support algorithm agility to transition when new algorithms are approved or deprecated?"
        dimension: lifecycle
      - id: Q4
        text: "Is Post-Quantum Cryptography (PQC) on your roadmap? Which algorithms are you evaluating?"
        dimension: roadmap
      - id: Q5
        text: "How do you handle cross-format algorithm compatibility (mDoc vs. SD-JWT-VC)?"
        dimension: interoperability

  # ============================================================================
  # VEND-ISS-019: Key Rotation Procedures
  # Requirement: Implement key rotation procedures
  # ============================================================================
  VEND-ISS-019:
    questions:
      - id: Q1
        text: "Do you have documented key rotation procedures?"
        dimension: capability
      - id: Q2
        text: "How do you transition to new signing keys while maintaining validity of previously issued attestations?"
        dimension: technical_implementation
      - id: Q3
        text: "What is the recommended key rotation frequency?"
        dimension: lifecycle
      - id: Q4
        text: "How is key rotation communicated to Trusted Lists and verifiers?"
        dimension: operational
      - id: Q5
        text: "What happens to attestations signed with retired keys—do they remain valid until expiry?"
        dimension: lifecycle
      - id: Q6
        text: "Is key rotation automated or does it require manual intervention?"
        dimension: automation

  # ============================================================================
  # VEND-ISS-020: Common Catalogue Registration (TS11)
  # Requirement: Publish attestation types to the Common Catalogue (TS11)
  # ============================================================================
  VEND-ISS-020:
    questions:
      - id: Q1
        text: "Do you support registration of attestation types in the Common Catalogue of Attestation Types per TS11?"
        dimension: capability
      - id: Q2
        text: "What information is published to the catalogue for each attestation type?"
        dimension: technical_implementation
      - id: Q3
        text: "How do wallets and RPs discover attestation types through the catalogue?"
        dimension: interoperability
      - id: Q4
        text: "How do you handle updates to catalogue entries when attestation types change?"
        dimension: lifecycle
      - id: Q5
        text: "Is catalogue registration automated as part of attestation type deployment?"
        dimension: automation

  # ============================================================================
  # VEND-ISS-021: Attestation Schema Documentation
  # Requirement: Document attestation schema including mandatory and optional attributes
  # ============================================================================
  VEND-ISS-021:
    questions:
      - id: Q1
        text: "Do you document and publish schemas for each attestation type?"
        dimension: capability
      - id: Q2
        text: "Do schemas clearly distinguish mandatory vs. optional attributes?"
        dimension: technical_implementation
      - id: Q3
        text: "What schema format do you use (JSON Schema, CDDL for mDoc, etc.)?"
        dimension: interoperability
      - id: Q4
        text: "How do you handle schema versioning and backwards compatibility?"
        dimension: lifecycle
      - id: Q5
        text: "Are schemas published in machine-readable formats for automated validation?"
        dimension: automation
      - id: Q6
        text: "Do schemas include semantic definitions for each attribute?"
        dimension: documentation

  # ============================================================================
  # VEND-ISS-022: Data Minimisation in Attestations
  # Requirement: Apply data minimisation principles to attestation content
  # ============================================================================
  VEND-ISS-022:
    questions:
      - id: Q1
        text: "How do you ensure attestations contain only attributes necessary for their intended purpose?"
        dimension: privacy
      - id: Q2
        text: "Do you design attestations to be selective disclosure-friendly?"
        dimension: technical_implementation
      - id: Q3
        text: "Can the organization configure which attributes are included in custom attestation types?"
        dimension: flexibility
      - id: Q4
        text: "Do you offer guidance on data minimization during attestation type design?"
        dimension: documentation
      - id: Q5
        text: "How do you handle requests to include unnecessary attributes in attestations?"
        dimension: compliance_monitoring

  # ============================================================================
  # VEND-ISS-023: No Tracking Identifiers
  # Requirement: Do not embed tracking identifiers in attestations
  # ============================================================================
  VEND-ISS-023:
    questions:
      - id: Q1
        text: "How do you ensure attestations do not contain overt or hidden tracking identifiers?"
        dimension: privacy
      - id: Q2
        text: "Are unique attestation identifiers designed to prevent cross-RP correlation?"
        dimension: technical_implementation
      - id: Q3
        text: "Do you conduct privacy reviews of attestation structures to identify potential correlation vectors?"
        dimension: compliance_monitoring
      - id: Q4
        text: "How do you handle serial numbers or other identifiers required by format specifications?"
        dimension: technical_implementation
      - id: Q5
        text: "Can the attestation structure be audited for privacy compliance by independent parties?"
        dimension: auditability

  # ============================================================================
  # VEND-ISS-024: Cross-Border Recognition
  # Requirement: Enable cross-border recognition of attestations
  # ============================================================================
  VEND-ISS-024:
    questions:
      - id: Q1
        text: "Are attestations issued through your platform verifiable and recognizable in all EU Member States?"
        dimension: capability
      - id: Q2
        text: "How do you ensure interoperability through adherence to common standards?"
        dimension: interoperability
      - id: Q3
        text: "Have you tested cross-border verification with wallets and verifiers from multiple Member States?"
        dimension: compliance_evidence
      - id: Q4
        text: "How do you handle Member State-specific attribute requirements or namespaces?"
        dimension: geographic_scope
      - id: Q5
        text: "What languages are supported for attestation attribute labels and values?"
        dimension: interoperability

  # ============================================================================
  # VEND-ISS-026: PID Rulebook Compliance
  # Note: VEND-ISS-025 does not exist in source
  # Requirement: Comply with PID Rulebook format and attribute requirements
  # ============================================================================
  VEND-ISS-026:
    questions:
      - id: Q1
        text: "Do you support Person Identification Data (PID) issuance compliant with the PID Rulebook?"
        dimension: capability
      - id: Q2
        text: "How do you implement namespace conventions as specified in the PID Rulebook?"
        dimension: technical_implementation
      - id: Q3
        text: "Do you support domestic namespace publication for national attributes?"
        dimension: capability
      - id: Q4
        text: "What portrait image quality and encoding requirements do you support?"
        dimension: technical_implementation
      - id: Q5
        text: "How do you handle CBOR encoding for mDoc format attributes?"
        dimension: technical_implementation
      - id: Q6
        text: "Have you validated PID format compliance with reference implementations?"
        dimension: compliance_evidence

  # ============================================================================
  # VEND-ISS-027: Mandatory Format Support per Rulebook
  # Requirement: Support all mandatory attestation formats for the attestation type
  # ============================================================================
  VEND-ISS-027:
    questions:
      - id: Q1
        text: "Do you offer attestations in all formats required by the applicable Rulebook?"
        dimension: capability
      - id: Q2
        text: "How do you track Rulebook changes that add new mandatory formats?"
        dimension: lifecycle
      - id: Q3
        text: "Do you validate format correctness against Rulebook specifications?"
        dimension: compliance_monitoring
      - id: Q4
        text: "How do you ensure encoding consistency across different formats (mDoc, SD-JWT-VC)?"
        dimension: technical_implementation

  # ============================================================================
  # VEND-ISS-028: Rulebook-Compliant Revocation
  # Requirement: Implement revocation according to applicable Rulebook specifications
  # ============================================================================
  VEND-ISS-028:
    questions:
      - id: Q1
        text: "Do you implement attestation revocation as specified in the applicable Rulebook?"
        dimension: capability
      - id: Q2
        text: "Do you meet the Rulebook-specified propagation times for revocation?"
        dimension: sla
      - id: Q3
        text: "Do you support suspension where the Rulebook requires it?"
        dimension: capability
      - id: Q4
        text: "How do you adapt revocation implementation when Rulebook specifications change?"
        dimension: lifecycle

  # ============================================================================
  # VEND-ISS-029: Registration Information Maintenance
  # Requirement: Maintain accurate registration information and update on changes
  # ============================================================================
  VEND-ISS-029:
    questions:
      - id: Q1
        text: "How do you ensure registration information remains accurate in Member State registries?"
        dimension: compliance_monitoring
      - id: Q2
        text: "What is the process for updating registration information when changes occur?"
        dimension: lifecycle
      - id: Q3
        text: "How quickly can registration updates be submitted and reflected in registries?"
        dimension: sla
      - id: Q4
        text: "Who is responsible for maintaining registration information—the organization or vendor?"
        dimension: operational
      - id: Q5
        text: "How do you alert the organization to registration information that may be out of date?"
        dimension: alerting

  # ============================================================================
  # VEND-ISS-030: Trust Anchor Publication
  # Requirement: Publish PID/Attestation Provider trust anchor information
  # ============================================================================
  VEND-ISS-030:
    questions:
      - id: Q1
        text: "Do you publish trust anchor information according to the Commission's common format?"
        dimension: capability
      - id: Q2
        text: "What information is included in the published trust anchor (signing certificates, algorithms, validity)?"
        dimension: technical_implementation
      - id: Q3
        text: "How do wallets and RPs access your trust anchor information?"
        dimension: interoperability
      - id: Q4
        text: "What is the process for Trusted List inclusion of your trust anchor?"
        dimension: lifecycle
      - id: Q5
        text: "How do you handle trust anchor updates during key rotation?"
        dimension: operational
      - id: Q6
        text: "What is the uptime SLA for trust anchor endpoints?"
        dimension: sla

  # ============================================================================
  # VEND-ISS-031: Wallet Unit Attestation Verification During Issuance
  # Requirement: Verify Wallet Unit Attestation during issuance
  # ============================================================================
  VEND-ISS-031:
    questions:
      - id: Q1
        text: "Do you verify the Wallet Unit Attestation (WUA) before issuing PIDs or device-bound attestations?"
        dimension: capability
      - id: Q2
        text: "What WUA verification checks do you perform (signature, certificate chain, revocation, WSCD certification)?"
        dimension: technical_implementation
      - id: Q3
        text: "How do you handle issuance requests from wallets with invalid or revoked WUAs?"
        dimension: operational
      - id: Q4
        text: "How do you stay updated on certified WSCD lists and WUA trust anchors?"
        dimension: lifecycle
      - id: Q5
        text: "What is the latency impact of WUA verification on the issuance process?"
        dimension: sla

  # ============================================================================
  # VEND-ISS-032: Embedded Disclosure Policies
  # Requirement: Include embedded disclosure policies in attestations
  # ============================================================================
  VEND-ISS-032:
    questions:
      - id: Q1
        text: "Do you support embedding disclosure policies in issued attestations?"
        dimension: capability
      - id: Q2
        text: "How do you define disclosure policies for different attestation types?"
        dimension: technical_implementation
      - id: Q3
        text: "How do Wallet Units interpret and enforce embedded disclosure policies?"
        dimension: interoperability
      - id: Q4
        text: "Can the organization customize disclosure policies for their attestations?"
        dimension: flexibility
      - id: Q5
        text: "What guidance do you provide on best practices for disclosure policy design?"
        dimension: documentation

  # ============================================================================
  # VEND-ISS-033: Registration Certificate Usage
  # Requirement: Use registration certificates for Provider authentication
  # ============================================================================
  VEND-ISS-033:
    questions:
      - id: Q1
        text: "Do you use registration certificates for Provider authentication in Wallet Unit interactions?"
        dimension: capability
      - id: Q2
        text: "How do you manage registration certificate lifecycle (renewal, revocation, key rotation)?"
        dimension: lifecycle
      - id: Q3
        text: "What certificate types do you support as registration certificates?"
        dimension: technical_implementation
      - id: Q4
        text: "How are registration certificates validated by Wallet Units?"
        dimension: interoperability
      - id: Q5
        text: "What happens if the registration certificate expires or is revoked during operations?"
        dimension: incident_response

  # ============================================================================
  # VEND-ISS-034: SD-JWT VC Format Compliance for PID
  # Requirement: Comply with SD-JWT VC format requirements for PID issuance
  # ============================================================================
  VEND-ISS-034:
    questions:
      - id: Q1
        text: "Do you issue PIDs in SD-JWT VC format compliant with ARF specifications?"
        dimension: capability
      - id: Q2
        text: "Do you correctly include required claims (vct, iss, iat, etc.) in SD-JWT VCs?"
        dimension: technical_implementation
      - id: Q3
        text: "How do you encode PID attributes per specification?"
        dimension: technical_implementation
      - id: Q4
        text: "Are all claims made selectively disclosable as required?"
        dimension: compliance_completeness
      - id: Q5
        text: "How do you handle date formatting requirements for SD-JWT VCs?"
        dimension: technical_implementation
      - id: Q6
        text: "Have you validated SD-JWT VC output against reference parsers?"
        dimension: compliance_evidence

  # ============================================================================
  # VEND-ISS-035: mDoc Format Compliance for PID
  # Requirement: Comply with mDoc format requirements for PID issuance
  # ============================================================================
  VEND-ISS-035:
    questions:
      - id: Q1
        text: "Do you issue PIDs in ISO 18013-5 mDoc format compliant with ARF specifications?"
        dimension: capability
      - id: Q2
        text: "Do you use correct document types (docType) and element identifiers?"
        dimension: technical_implementation
      - id: Q3
        text: "How do you handle CBOR encoding for mDoc attributes?"
        dimension: technical_implementation
      - id: Q4
        text: "Do you ensure each PID contains at most one attribute with the same identifier?"
        dimension: compliance_completeness
      - id: Q5
        text: "How do you handle namespace definitions for mDoc?"
        dimension: technical_implementation
      - id: Q6
        text: "Have you validated mDoc output against reference validators (e.g., ISO 18013-5 test suites)?"
        dimension: compliance_evidence

  # ============================================================================
  # VEND-ISS-036: Dual Status Mechanism Support
  # Requirement: Support both attestation status mechanisms
  # ============================================================================
  VEND-ISS-036:
    questions:
      - id: Q1
        text: "Do you support both the Attestation Status List mechanism and the Token Status List mechanism?"
        dimension: capability
      - id: Q2
        text: "How do Relying Parties know which status mechanism to use for a given attestation?"
        dimension: interoperability
      - id: Q3
        text: "Are both status mechanisms updated synchronously when revocation occurs?"
        dimension: technical_implementation
      - id: Q4
        text: "What are the performance characteristics of each status mechanism?"
        dimension: sla
      - id: Q5
        text: "Can the organization choose which status mechanisms to use?"
        dimension: flexibility

  # ============================================================================
  # VEND-ISS-037: Complete OpenID4VCI Implementation
  # Requirement: Implement complete OpenID4VCI protocol requirements
  # ============================================================================
  VEND-ISS-037:
    questions:
      - id: Q1
        text: "Do you implement all required elements of the OpenID4VCI protocol as specified in ARF HLRs?"
        dimension: capability
      - id: Q2
        text: "How do you structure credential offer payloads?"
        dimension: technical_implementation
      - id: Q3
        text: "What authorization flows do you support and how are they configured?"
        dimension: technical_implementation
      - id: Q4
        text: "How do you handle credential response formatting and error handling?"
        dimension: operational
      - id: Q5
        text: "Do you support notification endpoints for issuance status callbacks?"
        dimension: capability
      - id: Q6
        text: "How do you handle metadata discovery for the OpenID4VCI endpoints?"
        dimension: interoperability

  # ============================================================================
  # VEND-ISS-038: EAA Personal Data Isolation
  # Requirement: Do not combine EAA personal data with other services
  # ============================================================================
  VEND-ISS-038:
    questions:
      - id: Q1
        text: "How do you ensure personal data collected during EAA provision is NOT combined with data from other services?"
        dimension: architecture
      - id: Q2
        text: "Is there a formal data isolation policy documented and auditable?"
        dimension: compliance_evidence
      - id: Q3
        text: "How do you prevent EAA user profiles from being merged with marketing or analytics databases?"
        dimension: security
      - id: Q4
        text: "What controls prevent sharing EAA user data with commercial partner systems?"
        dimension: security
      - id: Q5
        text: "Can independent auditors verify data isolation compliance?"
        dimension: auditability
      - id: Q6
        text: "What are the consequences if data isolation is breached?"
        dimension: incident_response

  # ============================================================================
  # VEND-ISS-039: Logical Data Separation
  # Requirement: Keep EAA personal data logically separate
  # ============================================================================
  VEND-ISS-039:
    questions:
      - id: Q1
        text: "How do you implement logical separation of EAA-related personal data from other data?"
        dimension: architecture
      - id: Q2
        text: "What architectural approach do you use (separate databases, schemas, partitioning, tagging)?"
        dimension: technical_implementation
      - id: Q3
        text: "How are access controls enforced to prevent cross-data-store queries?"
        dimension: security
      - id: Q4
        text: "Is the logical separation verifiable through technical audits?"
        dimension: auditability
      - id: Q5
        text: "How does logical separation work in multi-tenant environments?"
        dimension: architecture
      - id: Q6
        text: "What happens to data separation in backup and disaster recovery scenarios?"
        dimension: operational

  # ============================================================================
  # VEND-ISS-040: QEAA Functional Separation
  # Requirement: Implement QEAA services functionally separate from other services
  # ============================================================================
  VEND-ISS-040:
    questions:
      - id: Q1
        text: "If offering QEAA services, how do you implement functional separation from other services?"
        dimension: architecture
      - id: Q2
        text: "Are QEAA operations handled by dedicated teams with organizational boundaries?"
        dimension: operational
      - id: Q3
        text: "Is QEAA infrastructure separated from non-QEAA infrastructure?"
        dimension: architecture
      - id: Q4
        text: "Are there independent governance structures for QEAA services?"
        dimension: operational
      - id: Q5
        text: "How is functional separation documented and audited for conformity assessment?"
        dimension: compliance_evidence
      - id: Q6
        text: "What level of personnel separation exists for QEAA operations?"
        dimension: operational
