# VCQ (Vendor Compliance Questionnaire) Configuration
# 
# This file configures the VCQ tool for assessing third-party intermediary vendors
# in the EUDIW ecosystem.
#
# Created: 2026-01-22
# Updated: 2026-01-26 (DEC-254: Consolidated PIF/VIF into single RP Intermediary)
# Decisions: DEC-222 (original), DEC-254 (consolidation)

schemaVersion: 1

# Tool metadata
tool:
  name: "Vendor Compliance Questionnaire"
  shortName: "VCQ"
  description: |
    Generate compliance questionnaires for Relying Parties evaluating
    third-party RP Intermediaries in the EUDIW ecosystem.
  version: "2.0.0"

# Intermediary Types
# DEC-254: Consolidated from separate PIF/VIF types into a single RP Intermediary.
# The previous distinction was not based on official regulatory terminology.
# ARF Topic 52 treats verification as part of the unified RP Intermediary role (RPI_09).
intermediaryTypes:
  intermediary:
    id: "intermediary"
    label: "RP Intermediary"
    shortLabel: "Intermediary"
    description: |
      An entity that acts on behalf of Relying Parties to interact with EUDI Wallets.
      Per Article 5b(10), intermediaries are legally deemed Relying Parties and must not 
      store transaction content. Per ARF RPI_09, intermediaries perform both forwarding 
      AND verification functions as a single unified role.
    icon: "üîó"
    prefix: "VEND-INT"
    arfTopics:
      - "Topic 52: RP Intermediaries"
      - "Topic 6: RP Authentication"
      - "Topic 1: Trust Infrastructure"
      - "Topic 7: Validity Status"
    keyCharacteristics:
      - "Receives and forwards wallet presentations"
      - "Displays both own and RP identity to wallet users"
      - "Performs cryptographic signature validation"
      - "Maintains up-to-date Trusted Lists"
      - "Verifies attestation revocation status"
      - "Subject to no-storage mandate (Art. 5b(10))"
    legalBasis:
      regulation: "2014/910"
      article: "Article 5b"
      paragraph: "10"

# Scope Extensions
# Additional regulatory scopes that can be toggled on
scopeExtensions:
  dora_ict:
    id: "dora_ict"
    label: "Extended: DORA ICT Third-Party Provisions"
    shortLabel: "DORA ICT"
    description: |
      For RPs that are financial entities under DORA (banks, investment firms, insurers),
      intermediary vendors qualify as ICT third-party service providers with additional
      contractual and oversight requirements.
    icon: "üè¶"
    prefix: "VEND-ICT"
    applicableWhen: "RP is a financial entity subject to DORA"
    primaryRegulation:
      id: "2022/2554"
      articles: ["28", "29", "30", "31"]
  
  gdpr_processor:
    id: "gdpr_processor"
    label: "Extended: GDPR Data Processor Requirements"
    shortLabel: "GDPR Processor"
    description: |
      When intermediaries process personal data on behalf of the RP, they act as
      data processors under GDPR and must meet Art. 28 requirements.
    icon: "üõ°Ô∏è"
    enabled: false  # Already covered in core requirements, but can add detailed breakdown
    prefix: "VEND-GDP"
    primaryRegulation:
      id: "2016/679"
      articles: ["28", "32", "33", "34"]

# Legal Sources for VCQ
# Regulations and documents from which requirements are derived
legalSources:
  primary:
    - id: "2014/910"
      name: "eIDAS Regulation (Consolidated)"
      shortName: "eIDAS 2.0"
      portalPath: "/regulation/2014-910"
    - id: "2024/1183"
      name: "Amending Regulation"
      shortName: "eIDAS Amendment"
      portalPath: "/regulation/2024-1183"
  
  implementing:
    - id: "2024/2979"
      name: "Integrity & Functionality Regulation"
      shortName: "Integrity Reg"
      portalPath: "/regulation/2024-2979"
    - id: "2024/2982"
      name: "Protocols & Interfaces Regulation"
      shortName: "Protocols Reg"
      portalPath: "/regulation/2024-2982"
    - id: "2025/847"
      name: "Suspension & Withdrawal Regulation"
      shortName: "Suspension Reg"
      portalPath: "/regulation/2025-847"
    - id: "2025/848"
      name: "Registration Regulation"  
      shortName: "Registration Reg"
      portalPath: "/regulation/2025-848"
  
  related:
    - id: "2016/679"
      name: "General Data Protection Regulation"
      shortName: "GDPR"
      portalPath: "/regulation/2016-679"
    - id: "2022/2554"
      name: "Digital Operational Resilience Act"
      shortName: "DORA"
      portalPath: "/regulation/2022-2554"
  
  architecture:
    - id: "ARF_1.5"
      name: "Architecture Reference Framework v1.5"
      shortName: "ARF"
      externalUrl: "https://github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework"
      topics:
        - id: "Topic52"
          name: "Relying Party Intermediaries"
          hlrPrefix: "RPI_"

# Output Configuration
output:
  views:
    - id: "summary"
      label: "Summary"
      description: "High-level compliance domains with requirement counts"
      icon: "üìä"
    - id: "table"
      label: "Requirements Table"
      description: "Structured table with all requirements"
      icon: "üìã"
      default: true
    - id: "questionnaire"
      label: "Questionnaire Export"
      description: "Exportable document for vendors"
      icon: "üì§"
  
  exportFormats:
    - id: "markdown"
      label: "Markdown"
      extension: ".md"
    - id: "pdf"
      label: "PDF Document"
      extension: ".pdf"

# Migration Notes (DEC-254)
# 
# Previous structure (v1):
#   - intermediaryTypes.pif (12 requirements, VEND-PIF-*)
#   - intermediaryTypes.vif (13 requirements, VEND-VIF-*)
#   - Step 1: Select PIF and/or VIF
#   - Step 2: Source Selection
#
# New structure (v2):
#   - intermediaryTypes.intermediary (25 requirements, VEND-INT-*)
#   - Step 1: Source Selection (no type selection needed)
#
# Rationale: ARF RPI_09 explicitly includes verification as part of the 
# RP Intermediary role. The PIF/VIF distinction was not official terminology.
