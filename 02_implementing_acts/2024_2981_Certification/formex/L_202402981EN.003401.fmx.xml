<?xml version="1.0" encoding="UTF-8"?>
<ANNEX xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://formex.publications.europa.eu/schema/formex-06.02.1-20231031.xd" NNC="YES"><BIB.INSTANCE><DOCUMENT.REF FILE="L_202402981EN.doc.fmx.xml"><COLL>L</COLL><NO.DOC FORMAT="YN" TYPE="OJ"><COM>EU</COM><YEAR>2024</YEAR><NO.CURRENT>2981</NO.CURRENT></NO.DOC><LG.OJ>EN</LG.OJ><PAGE.FIRST>1</PAGE.FIRST><PAGE.SEQ>1</PAGE.SEQ><VOLUME.REF>01</VOLUME.REF></DOCUMENT.REF><DATE ISO="20241128">20241128</DATE><LG.DOC>EN</LG.DOC><NO.SEQ>0001.0004</NO.SEQ><PAGE.FIRST>34</PAGE.FIRST><PAGE.SEQ>1</PAGE.SEQ><PAGE.LAST>37</PAGE.LAST><PAGE.TOTAL>4</PAGE.TOTAL></BIB.INSTANCE><TITLE><TI><P>ANNEX IV</P></TI><STI><P><HT TYPE="BOLD">METHODS AND PROCEDURES FOR EVALUATION ACTIVITIES</HT></P></STI></TITLE><CONTENTS><GR.SEQ LEVEL="1"><TITLE><TI><NP><NO.P>1.</NO.P><TXT><HT TYPE="BOLD">Audit of the implementation of a wallet solution</HT></TXT></NP></TI></TITLE><P>A conformity assessment activity shall consist of selecting specific evaluation activities.</P><P>National certification schemes shall specify an evaluation activity to assess the information provided, covering at least the following:</P><LIST TYPE="alpha"><ITEM><NP><NO.P>(a)</NO.P><TXT>an analysis of the information provided to confirm that it is suited for one of the architectures specified in national certification schemes;</TXT></NP></ITEM><ITEM><NP><NO.P>(b)</NO.P><TXT>an analysis of the coverage of the cybersecurity risks and threats identified in the risk register of Annex I by the described security controls.</TXT></NP></ITEM></LIST><P>The analysis mentioned in points (a) to (b) shall rely on the rationale and justification provided by the wallet provider.</P></GR.SEQ><GR.SEQ LEVEL="1"><TITLE><TI><NP><NO.P>2.</NO.P><TXT><HT TYPE="BOLD">Evaluation activities related to the wallet secure cryptographic device</HT></TXT></NP></TI></TITLE><LIST TYPE="ARAB"><ITEM><NP><NO.P>(1)</NO.P><TXT>Critical operations, including cryptographic computations, are not required to be fully implemented in the WSCD. However, the part implemented in the WSCD, when operating as part of the wallet solution, shall guarantee the protection of the critical operations it performs against attacks by attackers with high attack potential in accordance with Commission Implementing Regulation (EU) 2015/1502<NOTE NOTE.ID="E0001" NUMBERING="ARAB" NUMBERING.CONTINUED="YES" TYPE="FOOTNOTE"><P>Commission Implementing Regulation (EU) 2015/1502 of <DATE ISO="20150908">8 September 2015</DATE> on setting out minimum technical specifications and procedures for assurance levels for electronic identification means pursuant to Article 8(3) of Regulation (EU) No 910/2014 of the European Parliament and of the Council on electronic identification and trust services for electronic transactions in the internal market (<REF.DOC.OJ COLL="L" DATE.PUB="20150909" NO.OJ="235" PAGE.FIRST="7">OJ L 235, 9.9.2015, p. 7</REF.DOC.OJ>, ELI: <LINK URI="http://data.europa.eu/eli/reg_impl/2015/1502/oj">http://data.europa.eu/eli/reg_impl/2015/1502/oj</LINK>).</P></NOTE>.</TXT></NP></ITEM><ITEM><NP><NO.P>(2)</NO.P><TXT>The WSCD or part thereof may be within the object of certification when it is provided by the certificate holder or applicant, or outside of its scope when it is embedded in a device provided by the end user. In addition, national certification schemes shall specify the evaluation activities to verify the suitability of the WSCD, in the two following cases:</TXT><P><LIST TYPE="alpha"><ITEM><NP><NO.P>(a)</NO.P><TXT>if the WSCA depends on the particular WSCD (i.e. if it needs to be evaluated as a composite product based on the WSCD) then the evaluation of the WSCA shall require access to additional information related to the WSCD’s certification, including, in particular, its evaluation technical report;</TXT></NP></ITEM><ITEM><NP><NO.P>(b)</NO.P><TXT>if an architecture considered in the scheme uses several WSCDs, or if some of the operations on critical assets are performed outside of the WSCD, then national certification schemes shall include evaluation activities to ensure that the overall solution offers the expected level of security.</TXT></NP></ITEM></LIST></P></NP></ITEM><ITEM><NP><NO.P>(3)</NO.P><TXT>As a prerequisite to the certification under national certification schemes, the WSCD shall be assessed against the requirements of assurance level high as set out in Implementing Regulation (EU) 2015/1502.</TXT><P>When the conditions in Article 3(3), point (b) are fulfilled, the evaluation of the WSCD or part thereof shall include a vulnerability assessment as set out in EN ISO/IEC 15408-3:2022 at level AVA_VAN.5, as set out in Annex I of the Commission Implementing Regulation (EU) 2024/482<NOTE NOTE.ID="E0002" NUMBERING="ARAB" NUMBERING.CONTINUED="YES" TYPE="FOOTNOTE"><P>Commission Implementing Regulation (EU) 2024/482 of <DATE ISO="20240131">31 January 2024</DATE> laying down rules for the application of Regulation (EU) 2019/881 of the European Parliament and of the Council as regards the adoption of the European Common Criteria-based cybersecurity certification scheme (EUCC) (<REF.DOC COLL="L" CONTEXT="EUR-LEX" DATE.PUB="20240207" NO.DOC="482" URI="http://data.europa.eu/eli/reg_impl/2024/482/oj">OJ L, 2024/482, 7.2.2024, ELI: http://data.europa.eu/eli/reg_impl/2024/482/oj</REF.DOC>).</P></NOTE>, unless it is duly justified to the certification body that the security characteristics of the WSCA make it possible to use a lower assessment level while keeping the same overall assurance level high as set out in Implementing Regulation (EU) 2015/1502.</P></NP></ITEM><?PAGE NO="35"?><ITEM><NP><NO.P>(4)</NO.P><TXT>In addition, in the documentation related to each specific architecture, national certification schemes shall formulate assumptions for this evaluation of the WSCD under which resistance against attackers with high attack potential in accordance with Implementing Regulation (EU) 2015/1502 can be provided and specify the evaluation activities to confirm these assumptions and to confirm after issuance of the certificate that the assumptions are still verified. The national schemes shall also require the candidates to certification to refine these assumptions for their specific implementation, and to describe the measures in place to guarantee that the assumptions are verified throughout the certification lifecycle.</TXT></NP></ITEM><ITEM><NP><NO.P>(5)</NO.P><TXT>In all cases, national certification schemes shall include an evaluation activity to verify that the assurance information available for the WSCD is suitable for the purpose of the wallet solution, through an analysis of the assurance information, such as the security target for EUCC certificates, including the following activities:</TXT><P><LIST TYPE="alpha"><ITEM><NP><NO.P>(a)</NO.P><TXT>verifying that the scope of the evaluation is suitable, which for EUCC certificates, for instance, means verifying that the security target claims conformity to one of the protection profiles recommended in the EUCC;</TXT></NP></ITEM><ITEM><NP><NO.P>(b)</NO.P><TXT>verifying that the assumptions on the operating environment are compatible with the wallet solution, which for EUCC certificates, for instance, means that these assumptions can be found in the security target;</TXT></NP></ITEM><ITEM><NP><NO.P>(c)</NO.P><TXT>verifying that the recommendations in the user guidance or documentation are compatible with the conditions on which the WSCD is to be used in the wallet solution;</TXT></NP></ITEM><ITEM><NP><NO.P>(d)</NO.P><TXT>verifying that the assumptions made in the national certification scheme about WSCDs are verified and covered in the assurance information.</TXT></NP></ITEM></LIST></P></NP></ITEM><ITEM><NP><NO.P>(6)</NO.P><TXT>In cases where some of the verifications are not fully conclusive, national certification schemes shall require certification bodies to specify compensating requirements for the wallet secure cryptographic application (WSCA) based on the WSCD, to be included in the evaluation of the WSCA. If this is not possible, national certification schemes shall deem the WSCD unsuitable, meaning that the wallet solution shall not be issued a certificate of conformity.</TXT></NP></ITEM></LIST></GR.SEQ><GR.SEQ LEVEL="1"><TITLE><TI><NP><NO.P>3.</NO.P><TXT><HT TYPE="BOLD">Evaluation activities related to the wallet secure cryptographic application (WSCA)</HT></TXT></NP></TI></TITLE><LIST TYPE="ARAB"><ITEM><NP><NO.P>(1)</NO.P><TXT>National certification schemes shall require that a WSCA, as part of a wallet solution, is evaluated against the requirements of at least assurance level high as set out in Implementing Regulation (EU) 2015/1502.</TXT></NP></ITEM><ITEM><NP><NO.P>(2)</NO.P><TXT>This evaluation shall include a vulnerability assessment, as set out in EN ISO/IEC 15408-3:2022 at level AVA_VAN.5, as set out in Annex I of Implementing Regulation (EU) 2024/482, unless it is duly justified to the certification body that the security characteristics of the WSCA make it possible to use a lower assessment level while keeping the same overall assurance level high as set out in Implementing Regulation (EU) 2015/1502.</TXT></NP></ITEM><ITEM><NP><NO.P>(3)</NO.P><TXT>When the WSCA is not provided by the wallet provider, national certification schemes shall formulate assumptions for this evaluation of the WSCA under which resistance against attackers with high attack potential in accordance with Implementing Regulation (EU) 2015/1502 can be provided and specify the evaluation activities to confirm these assumptions and to confirm after issuance of the certificate that the assumptions are still verified. The national schemes shall also require the candidates to certification to refine these assumptions for their specific implementation, and to describe the measures in place to guarantee that the assumptions are verified throughout the certification lifecycle.</TXT></NP></ITEM><ITEM><NP><NO.P>(4)</NO.P><TXT>In all cases, national certification schemes shall include an evaluation activity to verify that the assurance information available for the WSCA is suitable for the purpose of the wallet solution, through an analysis of the assurance information, such as the security target for EUCC certificates, including the following activities:</TXT><P><LIST TYPE="alpha"><ITEM><NP><NO.P>(a)</NO.P><TXT>verifying that the scope of the evaluation is suitable, which for EUCC certificates, for instance, means verifying that the security target claims conformity to one of the protection profiles recommended in the EUCC;</TXT></NP></ITEM><ITEM><NP><NO.P>(b)</NO.P><TXT>verifying that the assumptions on the operating environment are compatible with the wallet solution, which for EUCC certificates, for instance, means that these assumptions can be found in the security target;</TXT></NP></ITEM><?PAGE NO="36"?><ITEM><NP><NO.P>(c)</NO.P><TXT>verifying that the recommendations in the user guidance or documentation are compatible with the conditions on which the WSCA is to be used in the wallet solution;</TXT></NP></ITEM><ITEM><NP><NO.P>(d)</NO.P><TXT>verifying that the assumptions made in the national certification scheme about WSCAs are verified and covered in the assurance information.</TXT></NP></ITEM></LIST></P></NP></ITEM><ITEM><NP><NO.P>(5)</NO.P><TXT>National certification schemes shall require that the evaluation of the WSCA covers all security controls implemented by this WSCA.</TXT></NP></ITEM></LIST></GR.SEQ><GR.SEQ LEVEL="1"><TITLE><TI><NP><NO.P>4.</NO.P><TXT><HT TYPE="BOLD">Evaluation activities related to the end user device</HT></TXT></NP></TI></TITLE><P>Since the risk register, as set out in Annex I of this Regulation, identifies risks that are directly linked to the security of the end user device, national certification schemes shall specify security requirements for end user devices. However, as these devices are provided by the end user and not by the wallet provider, these requirements shall be covered by assumptions.</P><P>For each assumption, the wallet solution shall include a mechanism to verify for every wallet unit that the underlying end user device satisfies the assumption. Such mechanisms shall be considered as security controls and covered by evaluation activities to demonstrate both their suitability and their effectiveness at the appropriate assurance level.</P><P>Two examples are set out below:</P><LIST TYPE="alpha"><ITEM><NP><NO.P>(a)</NO.P><TXT>an end user device may include a certified WSCD, which needs to be demonstrated. Typically, this would be done by using a cryptographic mechanism to verify the presence in the certified WSCD of a cryptographic secret that is only available in the certified WSCD. In this case, this cryptographic secret should be considered as a critical asset and be covered by the certification of the WSCD and/or of the WSCA;</TXT></NP></ITEM><ITEM><NP><NO.P>(b)</NO.P><TXT>a typical requirement for end user devices would be that the devices must receive security updates. Since this requirement is related to the wallet instance, the mechanism used to verify the availability of security updates only needs to be covered by evaluation activities at an assurance level suitable for the wallet instance, especially as it is likely to be integrated into the wallet instance.</TXT></NP></ITEM></LIST></GR.SEQ><GR.SEQ LEVEL="1"><TITLE><TI><NP><NO.P>5.</NO.P><TXT><HT TYPE="BOLD">Evaluation activities related to the wallet instance</HT></TXT></NP></TI></TITLE><LIST TYPE="ARAB"><ITEM><NP><NO.P>(1)</NO.P><TXT>The evaluation of the wallet instance shall consider the following two main challenges:</TXT><P><LIST TYPE="alpha"><ITEM><NP><NO.P>(a)</NO.P><TXT>the wallet instance is likely to exist in a set of variants of the same base application, with each variant specialised for a specific category of end user devices;</TXT></NP></ITEM><ITEM><NP><NO.P>(b)</NO.P><TXT>the different variants of the wallet instance will likely need frequent updates in order to follow the development of the underlying security platform, for instance when vulnerabilities are identified that require changes to applications.</TXT></NP></ITEM></LIST></P></NP></ITEM><ITEM><NP><NO.P>(2)</NO.P><TXT>The evaluation of the wallet instance shall take into consideration these specific challenges. One of the immediate consequences is that the Common Criteria framework may not be suitable in all cases. Therefore, alternative evaluation methodologies shall be considered where necessary. National certification schemes shall consider the use of the EN 17640:2018 methodology for the following:</TXT><P><LIST TYPE="alpha"><ITEM><NP><NO.P>(a)</NO.P><TXT>as part of the scheme itself;</TXT></NP></ITEM><ITEM><NP><NO.P>(b)</NO.P><TXT>through national schemes based on the methodology;</TXT></NP></ITEM><ITEM><NP><NO.P>(c)</NO.P><TXT>through national schemes based on similar principles but created before the development of the EN 17640:2018 methodology.</TXT></NP></ITEM></LIST></P></NP></ITEM><ITEM><NP><NO.P>(3)</NO.P><TXT>In addition, as there may be limited added value in performing a full dedicated evaluation of each variant, national certification schemes shall consider specifying criteria allowing sampling to be performed, in order to avoid repetition of identical evaluation activities and to focus on activities that are specific to a given variant. National certification schemes shall require all certification bodies to justify their use of sampling.</TXT></NP></ITEM><ITEM><NP><NO.P>(4)</NO.P><TXT>National certification schemes shall include updates of the wallet instance in the overall change management process specified for the wallet solution. They shall also lay down rules on the procedures that shall be performed by the wallet provider for every update (e.g. analysing the impact of the changes on the security controls), and on the evaluation activities that shall be performed by the certification body on updates under specified conditions (e.g. assessing the operating effectiveness of a modified security control). The change management process is one of the processes whose operating effectiveness is required to be checked annually in accordance with Article 18(3).</TXT></NP></ITEM></LIST></GR.SEQ><?PAGE NO="37"?><GR.SEQ LEVEL="1"><TITLE><TI><NP><NO.P>6.</NO.P><TXT><HT TYPE="BOLD">Evaluation activities related to the services and processes used for the provision and operation of the wallet solution</HT></TXT></NP></TI></TITLE><LIST TYPE="ARAB"><ITEM><NP><NO.P>(1)</NO.P><TXT>For the evaluation of services and processes that play a role in the provision and operation of the wallet solution and the electronic identification scheme under which they are provided, the evaluation team shall gather evidence by conducting evaluation activities that may include audit, inspection, verification and validation activities.</TXT></NP></ITEM><ITEM><NP><NO.P>(2)</NO.P><TXT>The certification body shall confirm the sufficiency and appropriateness of the evidence to provide sufficient assurance that the services and processes meet the certification requirements, by confirming the following:</TXT><P><LIST TYPE="alpha"><ITEM><NP><NO.P>(a)</NO.P><TXT>the accuracy of the information presented in the description of the processes and services;</TXT></NP></ITEM><ITEM><NP><NO.P>(b)</NO.P><TXT>the suitability of the design and the controls of the processes and services to meet the evaluation criteria;</TXT></NP></ITEM><ITEM><NP><NO.P>(c)</NO.P><TXT>the operating effectiveness of an implementation of these controls throughout a specified period before the evaluation.</TXT></NP></ITEM></LIST></P></NP></ITEM><ITEM><NP><NO.P>(3)</NO.P><TXT>The accuracy of the description and the operating effectiveness of an implementation of controls may be considered as verification objectives, in the sense of ISO/IEC 17000:2020, of the corresponding claims by the wallet provider (i.e. confirmation of fairness of events that have already occurred or results that have already been obtained), whereas the suitability of the design and the controls of the services and processes to meet the evaluation criteria may be considered as a validation objective, in the sense of ISO/IEC 17000:2020, of the corresponding claim by the wallet provider (i.e. confirmation of plausibility regarding an intended future use or projected outcome).</TXT></NP></ITEM><ITEM><NP><NO.P>(4)</NO.P><TXT>Considering that a wallet solution is not allowed to operate before being certified, operating effectiveness cannot be confirmed on the basis of the actual operation of the solution. Therefore, this shall be confirmed using evidence gathered during tests or pilots.</TXT></NP></ITEM><ITEM><NP><NO.P>(5)</NO.P><TXT>National certification schemes may already exist for specific services and processes, for instance for the onboarding of users. The use of such schemes shall be considered by national certification schemes, if applicable.</TXT></NP></ITEM></LIST></GR.SEQ><GR.SEQ LEVEL="1"><TITLE><TI><NP><NO.P>7.</NO.P><TXT><HT TYPE="BOLD">Evaluation activities related to the ICT services used for the provision and operation of the wallet solution</HT></TXT></NP></TI></TITLE><LIST TYPE="ARAB"><ITEM><NP><NO.P>(1)</NO.P><TXT>Some wallet architectures may rely on dedicated ICT services, including cloud services for the provision and operation of a wallet solution, and these services may host sensitive data as well as sensitive operations. In such a case, national certification schemes shall specify security requirements for these ICT services.</TXT></NP></ITEM><ITEM><NP><NO.P>(2)</NO.P><TXT>Many certification schemes already exist for ICT services, cloud services, and other sources of assurance information, including those listed in Annex II. National certification schemes shall rely, when available and applicable, on those existing mechanisms, through one of the following mechanisms:</TXT><P><LIST TYPE="alpha"><ITEM><NP><NO.P>(a)</NO.P><TXT>mandating the use of a specific scheme or of a selection of schemes, by specifying the conditions under which the ICT or cloud services is to be assessed using these schemes;</TXT></NP></ITEM><ITEM><NP><NO.P>(b)</NO.P><TXT>leaving the choice of the assessment to the wallet provider and use the dependency analysis activity to analyse the suitability of the assurance information obtained through these assessments.</TXT></NP></ITEM></LIST></P></NP></ITEM><ITEM><NP><NO.P>(3)</NO.P><TXT>In both cases, national certification schemes shall specify additional evaluation activities as needed to analyse or supplement the information obtained through these schemes.</TXT></NP></ITEM></LIST></GR.SEQ></CONTENTS></ANNEX>
